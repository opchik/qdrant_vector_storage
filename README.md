# Qdrant Vector Storage

Sync and async Python client for Qdrant vector database with built-in support for uploading MD files.


## –§—É–Ω–∫—Ü–∏–∏

- **–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º—ã** ‚Äî –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –º–æ–¥–µ–ª—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤** ‚Äî –ó–∞–≥—Ä—É–∂–∞–π—Ç–µ MD —Ñ–∞–π–ª—ã
- **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫** ‚Äî –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É –∏–ª–∏ –≤–µ–∫—Ç–æ—Ä—É
- **–ì–∏–±–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** ‚Äî –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ ID –∏–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏** ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–π
- **–ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** ‚Äî –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **–ü–æ–¥—Å–∫–∞–∑–∫–∏ —Ç–∏–ø–æ–≤** ‚Äî –ü–æ–ª–Ω–∞—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å –º–æ–¥–µ–ª—è–º–∏ Pydantic

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install qdrant_vector_storage
```

## üìö –ö–ª–∞—Å—Å—ã –∏ –º–µ—Ç–æ–¥—ã

### `QdrantSyncClient` / `QdrantAsyncClient`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `url` | `Optional[str]` | `None` | –ü–æ–ª–Ω—ã–π URL Qdrant (–Ω–∞–ø—Ä–∏–º–µ—Ä, http://localhost:6333) |
| `api_key` | `Optional[str]` | `None` | API-–∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| `host` | `Optional[str]` | `None` | –•–æ—Å—Ç Qdrant —Å–µ—Ä–≤–µ—Ä–∞ |
| `port` | `int` | `6333` | –ü–æ—Ä—Ç Qdrant —Å–µ—Ä–≤–µ—Ä–∞ |
| `timeout` | `int` | `60` | –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å–µ–∫) |
| `prefer_grpc` | `bool` | `False` | –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—Ç—å gRPC –ø—Ä–æ—Ç–æ–∫–æ–ª |

**–ú–µ—Ç–æ–¥—ã:**

#### Collection Management

| –ú–µ—Ç–æ–¥ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----------|------------|----------|
| `create_collection()` | `name: str`, `vector_size: int`, `distance: Union[str, Distance] = "COSINE"`, `on_disk_payload: bool = True`, `**kwargs` | `Dict[str, Any]` | –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é |
| `list_collections()` | `-` | `List[str]` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π |
| `get_collection_info()` | `name: str` | `Dict[str, Any]` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ |
| `delete_collection()` | `name: str` | `bool` | –£–¥–∞–ª—è–µ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—é |

#### File Upload

| –ú–µ—Ç–æ–¥ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----------|------------|----------|
| `upload_file()` | `collection_name: str`, `file_path: str`, `embedder: Callable`, `chunk_size: int = 1000`, `chunk_overlap: int = 200`, `metadata: Optional[Dict] = None`, `batch_size: int = 100` | `FileUploadResult` | –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é |
| `upload_documents()` | `collection_name: str`, `documents: List[Document]`, `batch_size: int = 100`, `wait: bool = True` | `List[str]` (ID –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤) | –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é |

#### Document Deletion

| –ú–µ—Ç–æ–¥ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----------|------------|----------|
| `delete_documents()` | `collection_name: str`, `document_ids: Optional[List[str]] = None`, `filter_condition: Optional[Dict] = None`, `wait: bool = True` | `int` (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö) | –£–¥–∞–ª—è–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ |
| `delete_by_metadata()` | `collection_name: str`, `metadata_key: str`, `metadata_value: Any`, `wait: bool = True` | `int` (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö) | –£–¥–∞–ª—è–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º |

#### Search

| –ú–µ—Ç–æ–¥ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----------|------------|----------|
| `search()` | `collection_name: str`, `query_vector: List[float]`, `limit: int = 10`, `score_threshold: Optional[float] = None`, `filter_condition: Optional[Dict] = None`, `with_payload: bool = True`, `with_vectors: bool = False` | `List[SearchResult]` | –ü–æ–∏—Å–∫ –ø–æ –≤–µ–∫—Ç–æ—Ä—É –∑–∞–ø—Ä–æ—Å–∞ |
| `search_by_text()` | `collection_name: str`, `query_text: str`, `embedder: Callable`, `limit: int = 10`, `**kwargs` | `List[SearchResult]` | –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É –∑–∞–ø—Ä–æ—Å–∞ |

#### Utilities

| –ú–µ—Ç–æ–¥ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----------|------------|----------|
| `count_documents()` | `collection_name: str`, `filter_condition: Optional[Dict] = None` | `int` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ |
| `healthcheck()` | `-` | `bool` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Qdrant |
| `close()` | `-` | `None` | –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ |

---

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### `CollectionConfig`

| –ü–æ–ª–µ | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `name` | `str` | **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** | –ò–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ |
| `vector_size` | `int` | **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** | –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤ |
| `distance` | `Distance` | `Distance.COSINE` | –ú–µ—Ç—Ä–∏–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è |
| `on_disk_payload` | `bool` | `True` | –•—Ä–∞–Ω–∏—Ç—å payload –Ω–∞ –¥–∏—Å–∫–µ |

#### `Document`

| –ü–æ–ª–µ | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `id` | `Optional[str]` | `None` | ID –¥–æ–∫—É–º–µ–Ω—Ç–∞ |
| `text` | `str` | **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π** | –¢–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ |
| `metadata` | `Dict[str, Any]` | `{}` | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ |
| `vector` | `Optional[List[float]]` | `None` | –í–µ–∫—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞ |

#### `SearchResult`

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | `str` | ID –¥–æ–∫—É–º–µ–Ω—Ç–∞ |
| `score` | `float` | –û—Ü–µ–Ω–∫–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏ (0-1) |
| `text` | `str` | –¢–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ |
| `metadata` | `Dict[str, Any]` | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ |

#### `FileUploadResult`

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `file_name` | `str` | –ò–º—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ |
| `file_type` | `FileType` | –¢–∏–ø —Ñ–∞–π–ª–∞ |
| `chunks_uploaded` | `int` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ |
| `document_ids` | `List[str]` | ID –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
| `collection_name` | `str` | –ò–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ |
| `timestamp` | `datetime` | –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ |

---

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ñ–∞–π–ª–æ–≤

| –§–æ—Ä–º–∞—Ç | –†–∞—Å—à–∏—Ä–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------------|----------|
| Markdown | `.md` | –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞ |
| JSON | `.json` | Pretty-printed JSON –∫–æ–Ω—Ç–µ–Ω—Ç |
| HTML | `.html`, `.htm` | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º script/style |
| LaTeX | `.tex`, `.latex` | –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ –∫–æ–º–∞–Ω–¥ |

---

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

**–ü–æ URL:**
```python
client = QdrantSyncClient(
    url="http://localhost:6333", 
    api_key="your-key"
)
```

**–ü–æ host/port:**
```python
client = QdrantSyncClient(
    host="localhost", 
    port=6333, 
    timeout=30
)
```

**–° gRPC:**
```python
client = QdrantSyncClient(
    url="http://localhost:6333", 
    prefer_grpc=True
)
```

